{"ast":null,"code":"import _slicedToArray from\"/Users/BrienOShane93/Documents/GitHub/react-intro/hurleymaker-assignment2/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState,useEffect,useContext}from\"react\";import{Grid,Header,Segment,List,Image,Button,Icon,Confirm}from\"semantic-ui-react\";import axios from\"../../axios-orders\";import Loader from\"../../components/Feedback/Loader/Loader\";import ErrorModal from\"../../components/Feedback/ErrorModal/ErrorModal\";import AuthContext from\"../../context/auth-context\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var YourAccount=function YourAccount(props){var auth=useContext(AuthContext);// ACCOUNT, ERROR AND LOADING STATE\nvar _useState=useState({user:null}),_useState2=_slicedToArray(_useState,2),accountState=_useState2[0],setAccountState=_useState2[1];var _useState3=useState({error:false,errorMessage:null}),_useState4=_slicedToArray(_useState3,2),errorState=_useState4[0],setErrorState=_useState4[1];var _useState5=useState({isLoading:true,loadFailed:false}),_useState6=_slicedToArray(_useState5,2),loadingState=_useState6[0],setLoadingState=_useState6[1];// Manage state of confirm deletion dialog\nvar _useState7=useState({open:false}),_useState8=_slicedToArray(_useState7,2),confirmState=_useState8[0],setConfirmState=_useState8[1];var open=function open(){return setConfirmState({open:true});};var close=function close(){return setConfirmState({open:false});};// FETCH ACCOUNT DETAILS\nuseEffect(function(){var uid=auth.userId;var path=\"/users/\"+uid;axios.get(path,{headers:{Authorization:\"Bearer \"+auth.token}}).then(function(response){setAccountState({user:response.data.user});}).catch(function(error){setErrorState({error:true,errorMessage:error.response.data.message});setLoadingState({isLoading:false,loadFailed:loadingState.loadFailed});});},[]);// UPDATE AND DELETE HANDLERS\nvar updateHandler=function updateHandler(){props.history.push({pathname:\"/update-account\",state:{user:accountState.user}});};var deleteHandler=function deleteHandler(){var uid=auth.userId;var path=\"/deleteuser/\"+uid;axios.delete(path,{headers:{Authorization:\"Bearer \"+auth.token}}).then(function(response){console.log(\"User deleted!\");auth.logout();props.history.push(\"/\");}).catch(function(error){var errorMsg=\"\";if(error.response){errorMsg=error.response.data.message;}else{errorMsg=\"There was a problem deleting your account\";}setErrorState({error:true,errorMessage:errorMsg});});};// ERROR HANDLER\nvar errorHandler=function errorHandler(){setErrorState({error:false,errorMessage:null});setLoadingState({isLoading:false,loadFailed:true});};// DISPLAY ACCOUNT\nvar account=errorState.error?/*#__PURE__*/_jsx(ErrorModal,{error:errorState.errorMessage,onClear:errorHandler}):/*#__PURE__*/_jsx(Loader,{active:loadingState.isLoading});if(accountState.user&&!errorState.error){account=/*#__PURE__*/_jsx(Grid,{children:/*#__PURE__*/_jsx(Grid.Row,{centered:true,children:/*#__PURE__*/_jsx(Grid.Column,{width:10,children:/*#__PURE__*/_jsx(Segment,{color:\"yellow\",children:/*#__PURE__*/_jsxs(Grid,{divided:true,children:[/*#__PURE__*/_jsxs(Grid.Column,{width:8,children:[/*#__PURE__*/_jsx(Header,{as:\"h3\",textAlign:\"center\",color:\"blue\",children:\"Your Details\"}),/*#__PURE__*/_jsxs(List,{children:[/*#__PURE__*/_jsxs(List.Item,{children:[/*#__PURE__*/_jsx(List.Icon,{name:\"user\"}),/*#__PURE__*/_jsx(List.Content,{children:/*#__PURE__*/_jsxs(\"b\",{children:[\"Name: \",accountState.user.name,\" \"]})})]}),/*#__PURE__*/_jsxs(List.Item,{children:[/*#__PURE__*/_jsx(List.Icon,{name:\"mail\"}),/*#__PURE__*/_jsx(List.Content,{children:/*#__PURE__*/_jsxs(\"b\",{children:[\"Email: \",accountState.user.email,\" \"]})})]}),/*#__PURE__*/_jsxs(List.Item,{children:[/*#__PURE__*/_jsx(List.Icon,{name:\"lock\"}),/*#__PURE__*/_jsxs(List.Content,{children:[/*#__PURE__*/_jsx(\"b\",{children:\"Password: \"}),\" \",\"\\u25AA\\u25AA\\u25AA\\u25AA\\u25AA\\u25AA\",\" \"]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"accountButtons\",children:[/*#__PURE__*/_jsxs(Button,{icon:true,labelPosition:\"left\",color:\"orange\",onClick:updateHandler,children:[/*#__PURE__*/_jsx(Icon,{name:\"pencil\"}),\"Update Your Details\"]}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsxs(Button,{icon:true,labelPosition:\"left\",color:\"red\",onClick:open,children:[\"Delete Your Account\",/*#__PURE__*/_jsx(Icon,{name:\"trash\"})]}),/*#__PURE__*/_jsx(Confirm,{open:confirmState.open,onCancel:close,onConfirm:deleteHandler,header:\"Are you sure?\",content:\"Deleting your account is a permanent action and cannot be undone\",cancelButton:\"Take me back\",confirmButton:\"Yes, delete my account permanently\"})]})]}),/*#__PURE__*/_jsx(Grid.Column,{width:8,textAlign:\"center\",children:/*#__PURE__*/_jsx(Image,{src:\"https://img.jamieoliver.com/jamieoliver/recipe-database/oldImages/large/1474_2_1430128688.jpg?tr=w-800,h-1066\",rounded:true,size:\"large\"})})]})})})})});}else if(loadingState.loadFailed){account=/*#__PURE__*/_jsx(\"p\",{children:\"User can't be found\"});}return/*#__PURE__*/_jsx(React.Fragment,{children:account});};export default YourAccount;","map":{"version":3,"sources":["/Users/BrienOShane93/Documents/GitHub/react-intro/hurleymaker-assignment2/frontend/src/containers/YourAccount/YourAccount.js"],"names":["React","useState","useEffect","useContext","Grid","Header","Segment","List","Image","Button","Icon","Confirm","axios","Loader","ErrorModal","AuthContext","YourAccount","props","auth","user","accountState","setAccountState","error","errorMessage","errorState","setErrorState","isLoading","loadFailed","loadingState","setLoadingState","open","confirmState","setConfirmState","close","uid","userId","path","get","headers","Authorization","token","then","response","data","catch","message","updateHandler","history","push","pathname","state","deleteHandler","delete","console","log","logout","errorMsg","errorHandler","account","name","email"],"mappings":"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","sourcesContent":["import React, { useState, useEffect, useContext } from \"react\";\r\nimport { Grid, Header, Segment, List, Image, Button, Icon, Confirm } from \"semantic-ui-react\";\r\nimport axios from \"../../axios-orders\";\r\n\r\nimport Loader from \"../../components/Feedback/Loader/Loader\";\r\nimport ErrorModal from \"../../components/Feedback/ErrorModal/ErrorModal\";\r\nimport AuthContext from \"../../context/auth-context\";\r\n\r\nconst YourAccount = (props) => {\r\n\r\n  const auth = useContext(AuthContext);\r\n\r\n  // ACCOUNT, ERROR AND LOADING STATE\r\n  const [accountState, setAccountState] = useState({\r\n    user: null,\r\n  });\r\n\r\n  const [errorState, setErrorState] = useState({\r\n    error: false,\r\n    errorMessage: null,\r\n  });\r\n\r\n  const [loadingState, setLoadingState] = useState({\r\n    isLoading: true,\r\n    loadFailed: false,\r\n  });\r\n\r\n  // Manage state of confirm deletion dialog\r\n  const [confirmState, setConfirmState] = useState({ open: false });\r\n  const open = () => setConfirmState({ open: true });\r\n  const close = () => setConfirmState({ open: false });\r\n\r\n  // FETCH ACCOUNT DETAILS\r\n  useEffect(() => {\r\n    let uid = auth.userId; \r\n    let path = \"/users/\" + uid;\r\n    axios\r\n      .get(path, { headers: { Authorization: \"Bearer \" + auth.token } })\r\n      .then((response) => {\r\n        setAccountState({ user: response.data.user });\r\n      })\r\n      .catch((error) => {\r\n        setErrorState({\r\n          error: true,\r\n          errorMessage: error.response.data.message,\r\n        });\r\n        setLoadingState({\r\n          isLoading: false,\r\n          loadFailed: loadingState.loadFailed,\r\n        });\r\n      });\r\n  }, []);\r\n\r\n  // UPDATE AND DELETE HANDLERS\r\n  const updateHandler = () => {\r\n    props.history.push({\r\n      pathname: \"/update-account\",\r\n      state: {\r\n        user: accountState.user,\r\n      },\r\n    });\r\n  };\r\n\r\n  const deleteHandler = () => {\r\n    let uid = auth.userId;\r\n    let path = \"/deleteuser/\" + uid;\r\n    axios\r\n      .delete(path, { headers: { Authorization: \"Bearer \" + auth.token } })\r\n      .then((response) => {\r\n        console.log(\"User deleted!\");\r\n        auth.logout();\r\n        props.history.push(\"/\");\r\n      })\r\n      .catch((error) => {\r\n        let errorMsg = \"\";\r\n        if (error.response) {\r\n          errorMsg = error.response.data.message;\r\n        } else {\r\n          errorMsg = \"There was a problem deleting your account\";\r\n        }\r\n        setErrorState({ error: true, errorMessage: errorMsg });\r\n      });\r\n  };\r\n\r\n  // ERROR HANDLER\r\n  const errorHandler = () => {\r\n    setErrorState({\r\n      error: false,\r\n      errorMessage: null,\r\n    });\r\n    setLoadingState({\r\n      isLoading: false,\r\n      loadFailed: true,\r\n    });\r\n  };\r\n\r\n  // DISPLAY ACCOUNT\r\n  let account = errorState.error ? (\r\n    <ErrorModal error={errorState.errorMessage} onClear={errorHandler} />\r\n  ) : (\r\n    <Loader active={loadingState.isLoading} />\r\n  );\r\n\r\n  if (accountState.user && !errorState.error) {\r\n    account = (\r\n      <Grid>\r\n        <Grid.Row centered>\r\n          <Grid.Column width={10}>\r\n            <Segment color=\"yellow\">\r\n              <Grid divided>\r\n                <Grid.Column width={8}>\r\n                  <Header as=\"h3\" textAlign=\"center\" color=\"blue\">\r\n                    Your Details\r\n                  </Header>\r\n                  <List>\r\n                    <List.Item>\r\n                      <List.Icon name=\"user\" />\r\n                      <List.Content>\r\n                        <b>Name: {accountState.user.name} </b>\r\n                      </List.Content>\r\n                    </List.Item>\r\n                    <List.Item>\r\n                      <List.Icon name=\"mail\" />\r\n                      <List.Content>\r\n                        <b>Email: {accountState.user.email} </b>\r\n                      </List.Content>\r\n                    </List.Item>\r\n                    <List.Item>\r\n                      <List.Icon name=\"lock\" />\r\n                      <List.Content>\r\n                        <b>Password: </b>{\" \"}\r\n                        &#9642;&#9642;&#9642;&#9642;&#9642;&#9642;{\" \"}\r\n                      </List.Content>\r\n                    </List.Item>\r\n                  </List>\r\n                  <div className=\"accountButtons\">\r\n                    <Button\r\n                      icon\r\n                      labelPosition=\"left\"\r\n                      color=\"orange\"\r\n                      onClick={updateHandler}\r\n                    >\r\n                      <Icon name=\"pencil\" />\r\n                      Update Your Details\r\n                    </Button>\r\n                    <br />\r\n                    <br />\r\n                    <Button\r\n                      icon\r\n                      labelPosition=\"left\"\r\n                      color=\"red\"\r\n                      onClick={open}\r\n                    >\r\n                      Delete Your Account\r\n                      <Icon name=\"trash\" />\r\n                    </Button>\r\n                    <Confirm\r\n                      open={confirmState.open}\r\n                      onCancel={close}\r\n                      onConfirm={deleteHandler}\r\n                      header=\"Are you sure?\"\r\n                      content=\"Deleting your account is a permanent action and cannot be undone\"\r\n                      cancelButton=\"Take me back\"\r\n                      confirmButton=\"Yes, delete my account permanently\"\r\n                    />\r\n                  </div>\r\n                </Grid.Column>\r\n                <Grid.Column width={8} textAlign=\"center\">\r\n                  <Image\r\n                    src=\"https://img.jamieoliver.com/jamieoliver/recipe-database/oldImages/large/1474_2_1430128688.jpg?tr=w-800,h-1066\"\r\n                    rounded\r\n                    size=\"large\"\r\n                  />\r\n                </Grid.Column>\r\n              </Grid>\r\n            </Segment>\r\n          </Grid.Column>\r\n        </Grid.Row>\r\n      </Grid>\r\n    );\r\n  } else if (loadingState.loadFailed) {\r\n    account = <p>User can't be found</p>;\r\n  }\r\n\r\n  return <React.Fragment>{account}</React.Fragment>;\r\n};\r\n\r\nexport default YourAccount;\r\n"]},"metadata":{},"sourceType":"module"}