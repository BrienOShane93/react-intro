{"ast":null,"code":"import _objectSpread from\"/Users/BrienOShane93/Documents/GitHub/react-intro/hurleymaker-assignment2/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _slicedToArray from\"/Users/BrienOShane93/Documents/GitHub/react-intro/hurleymaker-assignment2/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState,useEffect}from\"react\";import{Grid}from\"semantic-ui-react\";import axios from\"../../axios-orders\";import Menu from\"../../components/Menu/Menu\";import Order from\"../../components/Order/Order\";import Loader from\"../../components/Feedback/Loader/Loader\";import ErrorModal from\"../../components/Feedback/ErrorModal/ErrorModal\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var HurleyMaker=function HurleyMaker(props){// MENU, ERROR AND LOADING STATE AND GET TOPPINGS FROM FIREBASE\nvar _useState=useState({styles:[]}),_useState2=_slicedToArray(_useState,2),menuState=_useState2[0],setMenuState=_useState2[1];var _useState3=useState({error:false,errorMessage:null}),_useState4=_slicedToArray(_useState3,2),errorState=_useState4[0],setErrorState=_useState4[1];var _useState5=useState({isLoading:true,loadFailed:false}),_useState6=_slicedToArray(_useState5,2),loadingState=_useState6[0],setLoadingState=_useState6[1];useEffect(function(){axios.get(\"/\").then(function(response){var sortedStyles=response.data.styles.sort(function(a,b){return a.id-b.id;});setMenuState({styles:sortedStyles});}).catch(function(error){setErrorState({error:true,errorMessage:error.response.data.message});setLoadingState({isLoading:false,loadFailed:menuState.loadFailed});console.log(error.response);});},[]);// ORDER STATE\n// Set order state conditionally - either to old order state or starting state\nvar _useState7=useState({totalPrice:props.location.state?props.location.state.order.totalPrice:0,chosenStyles:props.location.state?props.location.state.order.chosenStyles:[]}),_useState8=_slicedToArray(_useState7,2),orderState=_useState8[0],setOrderState=_useState8[1];// EVENT HANDLERS - ADD TOPPING\nvar addStyleHandler=function addStyleHandler(id){var order=_objectSpread({},orderState);// find the chosen style in the menu\nvar menuIndex=menuState.styles.findIndex(function(style){return style.id===id;});// check if the style has already been added to the orderStyles array\nvar orderIndex=order.chosenStyles.findIndex(function(style){return style.id===id;});// if so, increase its count by 1\nif(orderIndex>-1){order.chosenStyles[orderIndex].count++;}// otherwise (i.e. this style is being added for the first time)\n// create this style and add it to the order styles array\nelse{// Save the id, name and price of the chosen style; set its count to 1\nvar chosenStyle={id:menuState.styles[menuIndex].id,name:menuState.styles[menuIndex].alt,price:menuState.styles[menuIndex].price,count:1};order.chosenStyles.push(chosenStyle);}// Calculate the new price\nvar newPrice=orderState.totalPrice+menuState.styles[menuIndex].price;// Update the order state with the new price and updated styles array\nsetOrderState({totalPrice:newPrice,chosenStyles:order.chosenStyles});};// EVENT HANDLERS - REMOVE STYLE\nvar removeStyleHandler=function removeStyleHandler(id){var order=_objectSpread({},orderState);// Find style with matching id from the orderToppings\nvar index=order.chosenStyles.findIndex(function(style){return style.id===id;});// Get the current price\nvar price=order.totalPrice;// If style was found, update the price and decrease the count\nif(index>=0){price=price-order.chosenStyles[index].price;order.chosenStyles[index].count--;// If the count is now 0, remove the style completely\nif(order.chosenStyles[index].count<1){order.chosenStyles.splice(index,1);}}// Update order state with updated price and updated styles array\nsetOrderState({totalPrice:price,chosenStyles:order.chosenStyles});};// EVENT HANDLERS - CHECK OUT\nvar checkoutHandler=function checkoutHandler(){props.history.push({pathname:\"place-order\",state:{order:orderState,menu:menuState.styles}});};// ERROR HANDLER\nvar errorHandler=function errorHandler(){setErrorState({error:false,errorMessage:null});setLoadingState({isLoading:false,loadFailed:true});};// DISABLE CHECKOUT BUTTON IF NO TOPPINGS CHOSEN\nvar checkoutDisabled=true;if(orderState.chosenStyles.length>0){checkoutDisabled=false;}// DISPLAY HURLEY MAKER MENU AND CONTROLS\nvar hurleymakerMenu=errorState.error?/*#__PURE__*/_jsx(ErrorModal,{error:errorState.errorMessage,onClear:errorHandler}):/*#__PURE__*/_jsx(Loader,{active:loadingState.isLoading});if(menuState.styles.length>0){hurleymakerMenu=/*#__PURE__*/_jsxs(Grid,{divided:\"vertically\",stackable:true,children:[/*#__PURE__*/_jsx(Grid.Row,{centered:true,children:/*#__PURE__*/_jsx(Menu,{menu:menuState.styles})}),/*#__PURE__*/_jsx(Order,{menu:menuState.styles,styleAdded:addStyleHandler,styleRemoved:removeStyleHandler,chosenStyles:orderState.chosenStyles,totalPrice:orderState.totalPrice,checkout:checkoutHandler,disabled:checkoutDisabled})]});}else if(loadingState.loadFailed){hurleymakerMenu=/*#__PURE__*/_jsx(\"p\",{children:\"We're having some issues loading the menu... Please try again later.\"});}return/*#__PURE__*/_jsx(\"div\",{children:hurleymakerMenu});};export default HurleyMaker;","map":{"version":3,"sources":["/Users/BrienOShane93/Documents/GitHub/react-intro/hurleymaker-assignment2/frontend/src/containers/HurleyMaker/HurleyMaker.js"],"names":["React","useState","useEffect","Grid","axios","Menu","Order","Loader","ErrorModal","HurleyMaker","props","styles","menuState","setMenuState","error","errorMessage","errorState","setErrorState","isLoading","loadFailed","loadingState","setLoadingState","get","then","response","sortedStyles","data","sort","a","b","id","catch","message","console","log","totalPrice","location","state","order","chosenStyles","orderState","setOrderState","addStyleHandler","menuIndex","findIndex","style","orderIndex","count","chosenStyle","name","alt","price","push","newPrice","removeStyleHandler","index","splice","checkoutHandler","history","pathname","menu","errorHandler","checkoutDisabled","length","hurleymakerMenu"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from \"react\";\r\nimport { Grid } from \"semantic-ui-react\";\r\nimport axios from \"../../axios-orders\";\r\n\r\nimport Menu from \"../../components/Menu/Menu\";\r\nimport Order from \"../../components/Order/Order\";\r\nimport Loader from \"../../components/Feedback/Loader/Loader\";\r\nimport ErrorModal from \"../../components/Feedback/ErrorModal/ErrorModal\";\r\n\r\nconst HurleyMaker = (props) => {\r\n\r\n  // MENU, ERROR AND LOADING STATE AND GET TOPPINGS FROM FIREBASE\r\n  const [menuState, setMenuState] = useState({\r\n    styles: [],\r\n  });\r\n\r\n  const [errorState, setErrorState] = useState({\r\n    error: false,\r\n    errorMessage: null,\r\n  });\r\n\r\n  const [loadingState, setLoadingState] = useState({\r\n    isLoading: true,\r\n    loadFailed: false,\r\n  });\r\n\r\n  useEffect(() => {\r\n    axios\r\n      .get(\"/\")\r\n      .then((response) => {\r\n        let sortedStyles = response.data.styles.sort(function (a, b) {\r\n          return a.id - b.id;\r\n        });\r\n        setMenuState({ styles: sortedStyles });\r\n      })\r\n      .catch((error) => {\r\n        setErrorState({\r\n          error: true,\r\n          errorMessage: error.response.data.message,\r\n        });\r\n        setLoadingState({ isLoading: false, loadFailed: menuState.loadFailed });\r\n        console.log(error.response);\r\n      });\r\n  }, []);\r\n\r\n  // ORDER STATE\r\n\r\n  // Set order state conditionally - either to old order state or starting state\r\n\r\n  const [orderState, setOrderState] = useState({\r\n    totalPrice: props.location.state\r\n      ? props.location.state.order.totalPrice\r\n      : 0,\r\n    chosenStyles: props.location.state\r\n      ? props.location.state.order.chosenStyles\r\n      : [],\r\n  });\r\n\r\n  // EVENT HANDLERS - ADD TOPPING\r\n\r\n  const addStyleHandler = (id) => {\r\n    let order = { ...orderState };\r\n\r\n    // find the chosen style in the menu\r\n    const menuIndex = menuState.styles.findIndex(\r\n      (style) => style.id === id\r\n    );\r\n\r\n    // check if the style has already been added to the orderStyles array\r\n    const orderIndex = order.chosenStyles.findIndex(\r\n      (style) => style.id === id\r\n    );\r\n\r\n    // if so, increase its count by 1\r\n    if (orderIndex > -1) {\r\n      order.chosenStyles[orderIndex].count++;\r\n    }\r\n    // otherwise (i.e. this style is being added for the first time)\r\n    // create this style and add it to the order styles array\r\n    else {\r\n      // Save the id, name and price of the chosen style; set its count to 1\r\n      const chosenStyle = {\r\n        id: menuState.styles[menuIndex].id,\r\n        name: menuState.styles[menuIndex].alt,\r\n        price: menuState.styles[menuIndex].price,\r\n        count: 1,\r\n      };\r\n      order.chosenStyles.push(chosenStyle);\r\n    }\r\n\r\n    // Calculate the new price\r\n    const newPrice =\r\n      orderState.totalPrice + menuState.styles[menuIndex].price;\r\n\r\n    // Update the order state with the new price and updated styles array\r\n    setOrderState({\r\n      totalPrice: newPrice,\r\n      chosenStyles: order.chosenStyles,\r\n    });\r\n  };\r\n\r\n  // EVENT HANDLERS - REMOVE STYLE\r\n\r\n  const removeStyleHandler = (id) => {\r\n    let order = { ...orderState };\r\n\r\n    // Find style with matching id from the orderToppings\r\n    const index = order.chosenStyles.findIndex(\r\n      (style) => style.id === id\r\n    );\r\n\r\n    // Get the current price\r\n    let price = order.totalPrice;\r\n\r\n    // If style was found, update the price and decrease the count\r\n    if (index >= 0) {\r\n      price = price - order.chosenStyles[index].price;\r\n      order.chosenStyles[index].count--;\r\n\r\n      // If the count is now 0, remove the style completely\r\n      if (order.chosenStyles[index].count < 1) {\r\n        order.chosenStyles.splice(index, 1);\r\n      }\r\n    }\r\n\r\n    // Update order state with updated price and updated styles array\r\n    setOrderState({\r\n      totalPrice: price,\r\n      chosenStyles: order.chosenStyles,\r\n    });\r\n  };\r\n\r\n  // EVENT HANDLERS - CHECK OUT\r\n\r\n  const checkoutHandler = () => {\r\n    props.history.push({\r\n      pathname: \"place-order\",\r\n      state: {\r\n        order: orderState,\r\n        menu: menuState.styles,\r\n      },\r\n    });\r\n  };\r\n\r\n  // ERROR HANDLER\r\n\r\n  const errorHandler = () => {\r\n    setErrorState({\r\n      error: false,\r\n      errorMessage: null,\r\n    });\r\n    setLoadingState({\r\n      isLoading: false,\r\n      loadFailed: true,\r\n    });\r\n  };\r\n\r\n  // DISABLE CHECKOUT BUTTON IF NO TOPPINGS CHOSEN\r\n\r\n  let checkoutDisabled = true;\r\n\r\n  if (orderState.chosenStyles.length > 0) {\r\n    checkoutDisabled = false;\r\n  }\r\n\r\n  // DISPLAY HURLEY MAKER MENU AND CONTROLS\r\n\r\n  let hurleymakerMenu = errorState.error ? (\r\n    <ErrorModal error={errorState.errorMessage} onClear={errorHandler} />\r\n  ) : (\r\n    <Loader active={loadingState.isLoading} />\r\n  );\r\n\r\n  if (menuState.styles.length > 0) {\r\n    hurleymakerMenu = (\r\n      <Grid divided=\"vertically\" stackable>\r\n        <Grid.Row centered>\r\n          <Menu menu={menuState.styles} />\r\n        </Grid.Row>\r\n        <Order\r\n          menu={menuState.styles}\r\n          styleAdded={addStyleHandler}\r\n          styleRemoved={removeStyleHandler}\r\n          chosenStyles={orderState.chosenStyles}\r\n          totalPrice={orderState.totalPrice}\r\n          checkout={checkoutHandler}\r\n          disabled={checkoutDisabled}\r\n        />\r\n      </Grid>\r\n    );\r\n  } else if (loadingState.loadFailed) {\r\n    hurleymakerMenu = (\r\n      <p>\r\n        We're having some issues loading the menu... Please try again later.\r\n      </p>\r\n    );\r\n  }\r\n\r\n  return <div>{hurleymakerMenu}</div>;\r\n};\r\n\r\nexport default HurleyMaker;\r\n"]},"metadata":{},"sourceType":"module"}